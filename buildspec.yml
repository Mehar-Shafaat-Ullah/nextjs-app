version: 0.2

phases:
  install:
    commands:
      - echo "Installing dependencies..."
      - npm install
  
  build:
    commands:
      # This command runs your static export build, creating the 'out' directory
      - echo "Starting Next.js static export build..."
      - npm run build
      
artifacts:
  # The 'out' directory contains the final static HTML and asset files 
  # generated by Next.js's static export. This is what CodePipeline will deploy.
  files:
    - '**/*'
  base-directory: out
  
# Caching is essential for speeding up subsequent builds.
cache:
  paths:
    # Cache the node_modules folder to avoid reinstalling everything on every build
    - 'node_modules/**/*'
